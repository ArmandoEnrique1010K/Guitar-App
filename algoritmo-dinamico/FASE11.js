export const cleanSoloNotes = [
  {
    rope: 1,
    frets: [
      {
        chord: 0,
        file: "00",
      },
      {
        chord: 1,
        file: "01",
      },
      {
        chord: 2,
        file: "02",
      },
      {
        chord: 3,
        file: "03",
      },
      {
        chord: 4,
        file: "04",
      },
      {
        chord: 5,
        file: "05",
      },
      {
        chord: 6,
        file: "06",
      },
      {
        chord: 7,
        file: "07",
      },
      {
        chord: 8,
        file: "08",
      },
      {
        chord: 9,
        file: "09",
      },
      {
        chord: 10,
        file: "10",
      },
      {
        chord: 11,
        file: "11",
      },
      {
        chord: 12,
        file: "12",
      },
      {
        chord: 13,
        file: "13",
      },
      {
        chord: 14,
        file: "14",
      },
      {
        chord: 15,
        file: "15",
      },
      {
        chord: 16,
        file: "16",
      },
      {
        chord: 17,
        file: "17",
      },
      {
        chord: 18,
        file: "18",
      },
      {
        chord: 19,
        file: "19",
      },
      {
        chord: 20,
        file: "20",
      },
      {
        chord: 21,
        file: "21",
      },
      {
        chord: 22,
        file: "22",
      },
    ],
  },
  {
    rope: 2,
    frets: [
      {
        chord: 0,
        file: "05",
      },
      {
        chord: 1,
        file: "06",
      },
      {
        chord: 2,
        file: "07",
      },
      {
        chord: 3,
        file: "08",
      },
      {
        chord: 4,
        file: "09",
      },
      {
        chord: 5,
        file: "10",
      },
      {
        chord: 6,
        file: "11",
      },
      {
        chord: 7,
        file: "12",
      },
      {
        chord: 8,
        file: "13",
      },
      {
        chord: 9,
        file: "14",
      },
      {
        chord: 10,
        file: "15",
      },
      {
        chord: 11,
        file: "16",
      },
      {
        chord: 12,
        file: "17",
      },
      {
        chord: 13,
        file: "18",
      },
      {
        chord: 14,
        file: "19",
      },
      {
        chord: 15,
        file: "20",
      },
      {
        chord: 16,
        file: "21",
      },
      {
        chord: 17,
        file: "22",
      },
      {
        chord: 18,
        file: "23",
      },
      {
        chord: 19,
        file: "24",
      },
      {
        chord: 20,
        file: "25",
      },
      {
        chord: 21,
        file: "26",
      },
      {
        chord: 22,
        file: "27",
      },
    ],
  },
  {
    rope: 3,
    frets: [
      {
        chord: 0,
        file: "10",
      },
      {
        chord: 1,
        file: "11",
      },
      {
        chord: 2,
        file: "12",
      },
      {
        chord: 3,
        file: "13",
      },
      {
        chord: 4,
        file: "14",
      },
      {
        chord: 5,
        file: "15",
      },
      {
        chord: 6,
        file: "16",
      },
      {
        chord: 7,
        file: "17",
      },
      {
        chord: 8,
        file: "18",
      },
      {
        chord: 9,
        file: "19",
      },
      {
        chord: 10,
        file: "20",
      },
      {
        chord: 11,
        file: "21",
      },
      {
        chord: 12,
        file: "22",
      },
      {
        chord: 13,
        file: "23",
      },
      {
        chord: 14,
        file: "24",
      },
      {
        chord: 15,
        file: "25",
      },
      {
        chord: 16,
        file: "26",
      },
      {
        chord: 17,
        file: "27",
      },
      {
        chord: 18,
        file: "28",
      },
      {
        chord: 19,
        file: "29",
      },
      {
        chord: 20,
        file: "30",
      },
      {
        chord: 21,
        file: "31",
      },
      {
        chord: 22,
        file: "32",
      },
    ],
  },
  {
    rope: 4,
    frets: [
      {
        chord: 0,
        file: "15",
      },
      {
        chord: 1,
        file: "16",
      },
      {
        chord: 2,
        file: "17",
      },
      {
        chord: 3,
        file: "18",
      },
      {
        chord: 4,
        file: "19",
      },
      {
        chord: 5,
        file: "20",
      },
      {
        chord: 6,
        file: "21",
      },
      {
        chord: 7,
        file: "22",
      },
      {
        chord: 8,
        file: "23",
      },
      {
        chord: 9,
        file: "24",
      },
      {
        chord: 10,
        file: "25",
      },
      {
        chord: 11,
        file: "26",
      },
      {
        chord: 12,
        file: "27",
      },
      {
        chord: 13,
        file: "28",
      },
      {
        chord: 14,
        file: "29",
      },
      {
        chord: 15,
        file: "30",
      },
      {
        chord: 16,
        file: "31",
      },
      {
        chord: 17,
        file: "32",
      },
      {
        chord: 18,
        file: "33",
      },
      {
        chord: 19,
        file: "34",
      },
      {
        chord: 20,
        file: "35",
      },
      {
        chord: 21,
        file: "36",
      },
      {
        chord: 22,
        file: "37",
      },
    ],
  },
  {
    rope: 5,
    frets: [
      {
        chord: 0,
        file: "19",
      },
      {
        chord: 1,
        file: "20",
      },
      {
        chord: 2,
        file: "21",
      },
      {
        chord: 3,
        file: "22",
      },
      {
        chord: 4,
        file: "23",
      },
      {
        chord: 5,
        file: "24",
      },
      {
        chord: 6,
        file: "25",
      },
      {
        chord: 7,
        file: "26",
      },
      {
        chord: 8,
        file: "27",
      },
      {
        chord: 9,
        file: "28",
      },
      {
        chord: 10,
        file: "29",
      },
      {
        chord: 11,
        file: "30",
      },
      {
        chord: 12,
        file: "31",
      },
      {
        chord: 13,
        file: "32",
      },
      {
        chord: 14,
        file: "33",
      },
      {
        chord: 15,
        file: "34",
      },
      {
        chord: 16,
        file: "35",
      },
      {
        chord: 17,
        file: "36",
      },
      {
        chord: 18,
        file: "37",
      },
      {
        chord: 19,
        file: "38",
      },
      {
        chord: 20,
        file: "39",
      },
      {
        chord: 21,
        file: "40",
      },
      {
        chord: 22,
        file: "41",
      },
    ],
  },
  {
    rope: 6,
    frets: [
      {
        chord: 0,
        file: "24",
      },
      {
        chord: 1,
        file: "25",
      },
      {
        chord: 2,
        file: "26",
      },
      {
        chord: 3,
        file: "27",
      },
      {
        chord: 4,
        file: "28",
      },
      {
        chord: 5,
        file: "29",
      },
      {
        chord: 6,
        file: "30",
      },
      {
        chord: 7,
        file: "31",
      },
      {
        chord: 8,
        file: "32",
      },
      {
        chord: 9,
        file: "33",
      },
      {
        chord: 10,
        file: "34",
      },
      {
        chord: 11,
        file: "35",
      },
      {
        chord: 12,
        file: "36",
      },
      {
        chord: 13,
        file: "37",
      },
      {
        chord: 14,
        file: "38",
      },
      {
        chord: 15,
        file: "39",
      },
      {
        chord: 16,
        file: "40",
      },
      {
        chord: 17,
        file: "41",
      },
      {
        chord: 18,
        file: "42",
      },
      {
        chord: 19,
        file: "43",
      },
      {
        chord: 20,
        file: "44",
      },
      {
        chord: 21,
        file: "45",
      },
      {
        chord: 22,
        file: "46",
      },
    ],
  },
];

// TECLAS ASIGNADAS PARA UN TECLADO QWERTY (TECLADO DE LATINOAMERICA)
export const keyboardKeys = [
  {
    row: 1,
    keys: ["1", "2", "3", "4", "5", "6", "7", "8", "9", "0", "'"],
  },
  {
    row: 2,
    keys: ["q", "w", "e", "r", "t", "y", "u", "i", "o", "p", "´"],
  },
  {
    row: 3,
    keys: ["a", "s", "d", "f", "g", "h", "j", "k", "l", "ñ", "{"],
  },
  {
    row: 4,
    keys: ["z", "x", "c", "v", "b", "n", "m", ",", ".", "-", "Shift"],
  },
  /*
  {
    row: 5,
    keys: [],
  },
  {
    row: 6,
    keys: [],
  },
  */
];

const keysByRow = 11 - 1;

export const getDynamicKeysAndChords = (
  file = cleanSoloNotes,
  firstRope = 1,
  secondRope = 2,
  thirdRope = 3,
  fourthRope = 4,
  fifthRope = 5,
  sixthRope = 6,
  firstRowKeys = 0,
  secondRowKeys = 1,
  thirdRowKeys = 2,
  fourthRowKeys = 3,
  fifthRowKeys = 4,
  sixthRowKeys = 5,
  startFromTheChord = 0,
  lockTheZeroChord = false,
  invertKeyboard = false
) => {
  let arrayRopes = [
    firstRope,
    secondRope,
    thirdRope,
    fourthRope,
    fifthRope,
    sixthRope,
  ].filter((r) => r != null);

  let arrayRowKeys = [
    firstRowKeys,
    secondRowKeys,
    thirdRowKeys,
    fourthRowKeys,
    fifthRowKeys,
    sixthRowKeys,
  ].filter((v) => v != null);

  let resultArray = [];

  file.forEach((arrayRopes, arrayRowKeys) => {
    let assignRowKeys =
      invertKeyboard === false
        ? keyboardKeys[arrayRowKeys]?.keys
        : keyboardKeys[keyboardKeys.length - 1 - arrayRowKeys]?.keys;

    let findRope = file.find((n) => n.rope === arrayRopes.rope);

    findRope.frets.forEach((element, index) => {
      if (index >= startFromTheChord && lockTheZeroChord === false) {
        if (index <= assignRowKeys?.length) {
          element.key = assignRowKeys[index - startFromTheChord];
        } else {
          element.key = undefined;
        }
      } else {
        element.key = undefined;
      }

      if (lockTheZeroChord === true && startFromTheChord === 0) {
        startFromTheChord = 1;
      }

      if (index === 0 && lockTheZeroChord === true) {
        const elementKey =
          assignRowKeys?.[0] !== undefined ? assignRowKeys?.[0] : "";
        if (elementKey) {
          element.key = elementKey;
        }
        // continue;
        return;
      }

      if (index !== 0 && lockTheZeroChord === true) {
        if (index >= startFromTheChord) {
          if (index < assignRowKeys?.length + keysByRow + 2) {
            element.key =
              assignRowKeys[index - startFromTheChord + 1] === undefined
                ? "ESTO SE DEBE OCULTAR"
                : assignRowKeys[index - startFromTheChord + 1];
          } else {
            element.key = "UNDEFINED";
          }
        } else {
          element.key = "ESTO SE DEBE OCULTAR";
        }
      }

      if (lockTheZeroChord === false) {
        if (index <= assignRowKeys?.length + keysByRow + 1) {
          element.key = assignRowKeys[index - startFromTheChord];
        } else {
          element.key = undefined;
        }
      }

      if (lockTheZeroChord === false && index <= startFromTheChord - 1) {
        element.key = "ESTO SE DEBE OCULTAR";
      }

      if (index > keysByRow + startFromTheChord) {
        element.key = "ESTO SE DEBE OCULTAR";
      }
    });

    let newFrets = findRope.frets.filter(
      (f) => f.key !== "ESTO SE DEBE OCULTAR"
    );

    resultArray = [...resultArray, { rope: arrayRopes.rope, frets: newFrets }];

    // MEJORO AQUI
  });

  return resultArray;

  //console.log(arrayRopes);
  //console.log(arrayRowKeys);
};

console.log(
  getDynamicKeysAndChords(
    cleanSoloNotes,
    // CUERDAS
    1,
    2,
    3,
    4,
    5,
    6,
    // TECLADO (4 y 5 son undefined)
    0,
    1,
    2,
    3,
    4,
    5,
    // Traste inicial
    0,
    // Bloqueo del traste cero
    false,
    // Invertir teclado
    false
  )
);
